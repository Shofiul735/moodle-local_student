define("local_student/main",["exports","jquery","core/modal_factory","core/modal_events","core/str"],(function(_exports,_jquery,_modal_factory,_modal_events,_str){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events);_exports.init=async()=>{let api_key;await(0,_str.get_string)("api_token","local_student").then((data=>{api_key=data})),(0,_jquery.default)(".local_student--delete").on("click",(e=>{let id=Number.parseInt(e.target.text.split("-")[1]);_modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:"Confirm delete",body:"Do you want to delete this record?"}).then((modal=>{modal.setSaveButtonText("Delete"),modal.getRoot().on(_modal_events.default.save,(()=>{let url=new URL("http://localhost/moodle/webservice/rest/server.php"),params={id:id,wstoken:api_key,wsfunction:"local_student_delete",moodlewsrestformat:"json"};url.search=new URLSearchParams(params).toString(),fetch(url,{method:"GET"}).then((respose=>{if(!respose.ok)throw Error("Database operation failed!");return respose.json()})).then((data=>(window.location.reload(),data))).catch((e=>{alert(e.message)}))})),modal.show()}))}))}}));

//# sourceMappingURL=main.min.js.map