{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["import $ from \"jquery\";\n//import Ajax from \"core/ajax\";\nimport ModalFactory from \"core/modal_factory\";\nimport ModalEvents from \"core/modal_events\";\n//import Notification from \"core/notification\";\n\nexport const init = () => {\n  $(\".local_student--delete\").on(\"click\", (e) => {\n    let id = Number.parseInt(e.target.text.split(\"-\")[1]);\n\n    ModalFactory.create({\n      type: ModalFactory.types.SAVE_CANCEL,\n      title: \"Confirm delete\",\n      body: \"Do you want to delete this record?\",\n    }).then((modal) => {\n      modal.setSaveButtonText(\"Delete\");\n      let root = modal.getRoot();\n\n      root.on(ModalEvents.save, () => {\n        let wsfunction = \"local_student_delete\";\n\n        let url = new URL(\"http://localhost/moodle/webservice/rest/server.php\");\n        let params = {\n          id,\n          wstoken: \"4a657cdb29cf703b5a81c08e9a3a7c2b\",\n          wsfunction,\n          moodlewsrestformat: \"json\",\n        };\n        url.search = new URLSearchParams(params).toString();\n        console.log(url);\n        fetch(url, {\n          method: \"GET\",\n        })\n          .then((respose) => {\n            if (!respose.ok) {\n              throw Error(\"Database operation failed!\");\n            }\n            return respose.json();\n          })\n          .then((data) => {\n            console.log(data);\n            window.location.href = $(location).attr(\"href\");\n            return data;\n          })\n          .catch((e) => {\n            alert(e.message);\n          });\n\n        // Ajax.call(request)[0]\n        //   .done(() => {\n        //     window.location.href = $(location).attr(\"href\");\n        //   })\n        //   .fail(Notification.exception);\n      });\n      modal.show();\n    });\n  });\n};\n"],"names":["on","e","id","Number","parseInt","target","text","split","create","type","ModalFactory","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","getRoot","ModalEvents","save","url","URL","params","wstoken","wsfunction","moodlewsrestformat","search","URLSearchParams","toString","console","log","fetch","method","respose","ok","Error","json","data","window","location","href","attr","catch","alert","message","show"],"mappings":"kdAMoB,yBAChB,0BAA0BA,GAAG,SAAUC,QACnCC,GAAKC,OAAOC,SAASH,EAAEI,OAAOC,KAAKC,MAAM,KAAK,2BAErCC,OAAO,CAClBC,KAAMC,uBAAaC,MAAMC,YACzBC,MAAO,iBACPC,KAAM,uCACLC,MAAMC,QACPA,MAAMC,kBAAkB,UACbD,MAAME,UAEZlB,GAAGmB,sBAAYC,MAAM,SAGpBC,IAAM,IAAIC,IAAI,sDACdC,OAAS,CACXrB,GAAAA,GACAsB,QAAS,mCACTC,WANe,uBAOfC,mBAAoB,QAEtBL,IAAIM,OAAS,IAAIC,gBAAgBL,QAAQM,WACzCC,QAAQC,IAAIV,KACZW,MAAMX,IAAK,CACTY,OAAQ,QAEPlB,MAAMmB,cACAA,QAAQC,SACLC,MAAM,qCAEPF,QAAQG,UAEhBtB,MAAMuB,OACLR,QAAQC,IAAIO,MACZC,OAAOC,SAASC,MAAO,mBAAED,UAAUE,KAAK,QACjCJ,QAERK,OAAO1C,IACN2C,MAAM3C,EAAE4C,eASd7B,MAAM8B"}